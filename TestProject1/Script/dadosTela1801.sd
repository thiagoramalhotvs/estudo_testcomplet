uses
  acessarPlanilha;

procedure CriandoVerbaRebaixaDeCusto();
var dadosPlanilha : OleVariant;

begin
  dadosPlanilha := acessarPlanilha.AbrirPlanilha('DDT\Rotina_1801.xlsx', 'DADOS');

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('Panel1').VCLObject('btnNOVO').Click();

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('cmbFILIAL').Click();

  Sys.Process('PCSIS1801').Window('TPopupDataList', '', 1).Click();

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('rdgTipoVerba').Window('TGroupButton', dadosPlanilha.Value['TIPOVERBA'], 3).Click();

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('PsqEdtFornecedor').Keys(dadosPlanilha.Value['FORNECEDOR'] + '[Enter]');

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('PsqEdtComprador').Keys(dadosPlanilha.Value['COMPRADOR'] + '[Enter]');

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('edtDTVENC').Keys(dadosPlanilha.Value['DTVENC']);

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('dbEditValorVerba').Keys(dadosPlanilha.Value['VALOR']);

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('dbgFPGTO').Window('TGroupButton', dadosPlanilha.Value['FPGTO'], 1).Click();

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('dbHistorico1').Keys(dadosPlanilha.Value['HISTORICO']);

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('gbConta').VCLObject('psqCONTA').Keys(dadosPlanilha.Value['CONTA'] + '[Enter]');

  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('Panel1').VCLObject('btnGravar').Click();
  
  Sys.Process('PCSIS1801').Window('TMessageForm', 'Confirmação', 1).VCLObject(dadosPlanilha.Value['CONFIRMACAO']).Click();

  Sys.Process('PCSIS1801').Window('TMessageForm', 'Confirmação', 1).VCLObject(dadosPlanilha.Value['IMPCONTRATO']).Click();

end;

procedure fecharRotina();
begin
  Sys.Process('PCSIS1801').VCLObject('frmPCINF1801').VCLObject('WallpaperRotinaPC1').VCLObject('sbxFormulario').VCLObject('Panel1').VCLObject('BitBtn3').Click();
end;
